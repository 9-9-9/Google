<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Gso by lenbo-ma</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Gso</h1>
        <p>使用NodeJs编写的谷歌搜索代理程序</p>

        <p class="view"><a href="https://github.com/lenbo-ma/gso">View the Project on GitHub <small>lenbo-ma/gso</small></a></p>


        <ul>
          <li><a href="https://github.com/lenbo-ma/gso/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/lenbo-ma/gso/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/lenbo-ma/gso">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="gsogoogle-so" class="anchor" href="#gsogoogle-so" aria-hidden="true"><span class="octicon octicon-link"></span></a>gso(Google So)</h1>

<p>这是一个用Node.JS编写的Google搜索服务，原理是拿着用户的关键词去Google服务器搜索，然后将返回的结果响应给用户。</p>

<p><a href="https://github.com/lenbo-ma/gso/wiki/%E5%8F%AF%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%88%97%E8%A1%A8">可用服务列表</a></p>

<p>关于证书的说明：文件列表中提供的证书仅为测试使用，在生产环境下需替换为你自己的证书</p>

<hr>

<h2>
<a id="部署" class="anchor" href="#%E9%83%A8%E7%BD%B2" aria-hidden="true"><span class="octicon octicon-link"></span></a>部署</h2>

<h3>
<a id="安装" class="anchor" href="#%E5%AE%89%E8%A3%85" aria-hidden="true"><span class="octicon octicon-link"></span></a>安装：</h3>

<div class="highlight highlight-sh"><pre>git clone https://github.com/lenbo-ma/gso.git
<span class="pl-s3">cd</span> gso
npm install --production</pre></div>

<h3>
<a id="运行命令" class="anchor" href="#%E8%BF%90%E8%A1%8C%E5%91%BD%E4%BB%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>运行命令：</h3>

<h4>
<a id="测试调试" class="anchor" href="#%E6%B5%8B%E8%AF%95%E8%B0%83%E8%AF%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>测试/调试：</h4>

<p><code>npm start</code> 或 <code>node ./bin/run</code></p>

<h4>
<a id="生产环境" class="anchor" href="#%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83" aria-hidden="true"><span class="octicon octicon-link"></span></a>生产环境</h4>

<ul>
<li><p>使用<a href="https://github.com/nodejitsu/forever">forever</a>启动：<br>
<code>forever start -e err.log -o output.log ./bin/run</code></p></li>
<li><p>使用<a href="https://github.com/Unitech/pm2">pm2</a>启动：<br>
<code>pm2 start ./bin/run -i max</code></p></li>
</ul>

<h2>
<a id="自定义设置" class="anchor" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AE%BE%E7%BD%AE" aria-hidden="true"><span class="octicon octicon-link"></span></a>自定义设置</h2>

<h3>
<a id="站点名称" class="anchor" href="#%E7%AB%99%E7%82%B9%E5%90%8D%E7%A7%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>站点名称</h3>

<p>设置站点名称后会在首页logo下，浏览器标题栏中显示。
修改conf/config.js文件, 找到name节点, 修改为自己的站点名：</p>

<div class="highlight highlight-javascript"><pre>name<span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>谷搜客<span class="pl-pds">'</span></span></pre></div>

<h3>
<a id="统计脚本" class="anchor" href="#%E7%BB%9F%E8%AE%A1%E8%84%9A%E6%9C%AC" aria-hidden="true"><span class="octicon octicon-link"></span></a>统计脚本</h3>

<p>将脚本粘贴到views/partials/statistics.ejs文件中</p>

<h3>
<a id="首页随机文字" class="anchor" href="#%E9%A6%96%E9%A1%B5%E9%9A%8F%E6%9C%BA%E6%96%87%E5%AD%97" aria-hidden="true"><span class="octicon octicon-link"></span></a>首页随机文字</h3>

<p>将文字粘贴到data/words.txt中，每句以一个空行分割, 支持html代码</p>

<h3>
<a id="设置多个google-ip防止被屏蔽" class="anchor" href="#%E8%AE%BE%E7%BD%AE%E5%A4%9A%E4%B8%AAgoogle-ip%E9%98%B2%E6%AD%A2%E8%A2%AB%E5%B1%8F%E8%94%BD" aria-hidden="true"><span class="octicon octicon-link"></span></a>设置多个Google IP防止被屏蔽</h3>

<p>将可用的IP放入conf/ip.txt文件中,每个ip以一个回车换行分割.</p>

<h3>
<a id="设置http代理服务器" class="anchor" href="#%E8%AE%BE%E7%BD%AEhttp%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>设置HTTP代理服务器</h3>

<p>有时,我们可能需要设置一个代理服务器,比如google的ip失效暂时无法使用或被google屏蔽的时候.
修改conf/config.js文件, 找到proxy节点:</p>

<div class="highlight highlight-javascript"><pre>proxy<span class="pl-k">:</span> { 
      enable<span class="pl-k">:</span> <span class="pl-c1">false</span>,  <span class="pl-c">//设置是否启用</span>
      timeout<span class="pl-k">:</span> <span class="pl-c1">5000</span>,  <span class="pl-c">//设置超时时间, enable为true时有效</span>
      host<span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>,  <span class="pl-c">//代理服务器地址</span>
      port<span class="pl-k">:</span> <span class="pl-c1">80</span>  <span class="pl-c">//代理服务器端口</span>
  }</pre></div>

<h3>
<a id="静态文件压缩" class="anchor" href="#%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E5%8E%8B%E7%BC%A9" aria-hidden="true"><span class="octicon octicon-link"></span></a>静态文件压缩</h3>

<p>clone后的代码是未压缩的，可以使用grunt工具进行压缩。</p>

<h4>
<a id="压缩jscss文件" class="anchor" href="#%E5%8E%8B%E7%BC%A9jscss%E6%96%87%E4%BB%B6" aria-hidden="true"><span class="octicon octicon-link"></span></a>压缩js，css文件</h4>

<ol>
<li>安装grunt工具: <code>npm install -g grunt-cli</code>
</li>
<li>在项目根目录执行<code>grunt static</code>命令</li>
<li>修改conf/config.js中的r_prefix值为<code>/public</code>
</li>
</ol>

<p>注：执行grunt命令前必须使用<code>npm install</code>安装依赖，而不是<code>npm install --production</code></p>

<h4>
<a id="html代码压缩" class="anchor" href="#html%E4%BB%A3%E7%A0%81%E5%8E%8B%E7%BC%A9" aria-hidden="true"><span class="octicon octicon-link"></span></a>html代码压缩</h4>

<p>启动服务前设置<code>NODE_ENV</code>为<code>production</code>即可，如<code>NODE_ENV=production forever start bin/run</code></p>

<h2>
<a id="完成记录" class="anchor" href="#%E5%AE%8C%E6%88%90%E8%AE%B0%E5%BD%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>完成记录</h2>

<ol>
<li>增加“相关搜索”功能;</li>
<li>OpenSearch, 支持IE，Firefox，Chrome设置为默认搜索引擎;</li>
<li>简单的敏感词检测，否则连接会被墙/连接重置;</li>
<li>HTML代码压缩，基于html-minifier模块进行压缩已渲染好的HTML代码;</li>
<li>headroom功能(当页面向下滚动时，搜索区消失，当页面向上滚动时，搜索区又出现了。个人觉得这个体验对小屏幕笔记本及pad比较好，尤其是手机终端);</li>
<li>实现HTTPS功能(关键词加密);</li>
<li>使用cheeio替代jQuery解析;</li>
<li>输入框自动完成;</li>
<li>搜索内容语言切换;</li>
<li>根据时间段筛选结果;</li>
<li>使用filetype指令搜索时，结果项前缀显示filetype;</li>
<li>支持设置多个Google IP(2014-12-25);</li>
<li>增加HTTP代理功能(2014-12-28);</li>
<li>优化手机端使用体验(2015-1-13);</li>
<li>支持键盘快捷键(2015-1-13);</li>
</ol>

<h2>
<a id="todo" class="anchor" href="#todo" aria-hidden="true"><span class="octicon octicon-link"></span></a>TODO</h2>

<ul>
<li>[ ] Pad显示优化，字体优化;</li>
<li>[ ] 支持维基百科检索;</li>
<li>[ ] 优化错误日志记录;</li>
<li>[ ] 支持视频元信息检索(同时检索可播放来源)</li>
<li>[ ] 增加在线代理功能(代理搜索结果中出现的部分被屏蔽的网站)；</li>
</ul>

<h2>
<a id="copyright--license" class="anchor" href="#copyright--license" aria-hidden="true"><span class="octicon octicon-link"></span></a>Copyright &amp; License</h2>

<p>Copyright (c) 2014-2015  Released under the <a href="LICENSE">MIT license</a>.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/lenbo-ma">lenbo-ma</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-42596364-3");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>